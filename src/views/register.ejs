
  <% include ./layouts/header %>
  <div class="container">
    <form id="registerForm" class="form" action="/api/register" method="post">
      <div class="form-group">
        <label class="form-label">用户名</label>
        <input type="text" class="form-control" name="username" placeholder="请输入用户名" />
      </div>
      <div class="form-group">
        <label class="form-label">密码</label>
        <input type="password" class="form-control" name="password" placeholder="请输入用户名" />
      </div>
      <div class="alert alert-danger" style="display: none"></div>
      <div class="form-group">
        <input type="submit" class="btn btn-primary" value="提交" />
      </div>
    </form>
  </div>
  <script>
  jQuery(function(){
    $('#registerForm').submit(function(event){
      event.preventDefault();
      var $this = $(this);
      var $alert = $(this).find('.alert');
      $alert.hide()
      $.ajax({
        url: '/api/register',
        method: 'post',
        dataType: 'json',
        // data: $(this).serialize()
        data: {
          username: $(this).find('input[name=username]').val(),
          password: $(this).find('input[name=password]').val(),
        }
      })
      .done(function(data){
        if(!data.code){
          $alert.html(data.message).show();
          return false;
        }
        $alert.html('注册成功').toggleClass('alert-danger alert-success');
        setTimeout(() => {
          window.location = '/login';
        }, 3000);
      })
      .fail(function(xhr, status, statusText){
        console.log(xhr, status, statusText);
      });
    });


  });
  </script>
  <% include ./layouts/footer %>